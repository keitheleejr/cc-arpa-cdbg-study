---
title: "Camden County ARPA Needs Assessment Results"
author: "Dr. Keith Lee & Dr. Joseph Robbins"
affiliaton: "Valdosta State University"
date: "`r Sys.Date()`"
output: pdf_document
fontsize: 12pt
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

```{r load libraries, include=FALSE}
library(tidyverse)
library(scales)
library(readxl)
library(ggthemes)
library(gt)
library(gtExtras)
```

```{r load data, include=FALSE}
colnames <- as.character(read_excel("qualtrics-data.xlsx", 
                                    na = "",
                                    n_max = 1, 
                                    col_names = FALSE)) # creates data frame of column names

qualtrics_data <- read_excel("qualtrics-data.xlsx", 
                             skip = 2, # skips variable names and questions
                             col_names = colnames) %>% # merges imported data `colnames`
  filter(Status == "IP Address") # filter out SPAM and Survey Preview
```


```{r data cleaning}
qualtrics_data <- qualtrics_data %>% 
  mutate(age = case_when(
    grepl("[^0-9]", age) ~ "NA", # [^0-9] means "any character except the digits 0 - 9
    TRUE ~ age
  )) %>% 
  mutate(age = as.numeric(age))




```





```{r age, include=FALSE}


qualtrics_data %>% 
  filter(age > 0) %>% 
  summarize(mean_age = mean(age),
            median_age = median(age),
            range_age = range(age),
            sd_age = sd(age),
            n())
```



# ARPA Questionnaire

### Which option best describes your current housing situation?

```{r housing}
housing <- as.data.frame(table(qualtrics_data$housing)) %>% # create data frame
  mutate(Percentage = round(Freq/sum(Freq)*100,2)) %>%  # create new column with proportions
  arrange(desc(Percentage)) 

housing_table <- housing %>% 
  gt() %>% 
  cols_label(Var1 = "Response",
             Freq = "Count") %>% 
  cols_align(
    align = "left",
    columns = Var1
  ) # add additional cols_align if need to align additional columns

housing_table
```

### How many people live in your home?

```{r residents}


residents <- as.data.frame(table(qualtrics_data$residents)) %>% 
  mutate(Percentage = round(Freq/sum(Freq)*100,2)) 

residents_table <- residents %>% 
  gt() %>% 
  cols_label(Var1 = "Response",
             Freq = "Count") %>% 
  cols_align(
    align = "left",
    columns = Var1
  )

residents_table

```

\newpage

### Are there any individuals living in your household who are younger than 18 years old?

```{r under18}
under18 <- as.data.frame(table(qualtrics_data$under18)) %>% 
  mutate(Percentage = round(Freq/sum(Freq)*100,2)) %>% 
  arrange(desc(Percentage))

under18_table <- under18 %>% 
  gt() %>% 
  cols_label(Var1 = "Response",
             Freq = "Count") %>% 
  cols_align(
    align = "left",
    columns = Var1
  )

under18_table
```


### If yes, how many?

```{r under18count}
qualtrics_data$under18count <- recode(qualtrics_data$under18count,
                                      One = "1")

under18count <- as.data.frame(table(qualtrics_data$under18count)) %>% 
  mutate(Percentage = round(Freq/sum(Freq)*100,2)) 

under18count_table <- under18count %>% 
  gt() %>% 
  cols_label(Var1 = "Response",
             Freq = "Count") %>% 
  cols_align(
    align = "left",
    columns = Var1
  )

under18count_table
```

### Do you live in a single-parent household?

```{r singleparent}

qualtrics_data$singleparent <- recode(qualtrics_data$singleparent,
                                      "yes" = "Yes",
                                      "no" = "No",
                                      "NO" = "No",
                                      "1" = "No",
                                      "Divorced" = "No",
                                      "Just me  childen are all married" = "No",
                                      "My son moved in after , I lost my husband to covid." = "No",
                                      "N/a" = "No",
                                      "N/A" = "No",
                                      "Na" = "No",
                                      "NA" = "No",
                                      "O" = "No",
                                      "Widow" = "No") 



singleparent <- as.data.frame(table(qualtrics_data$singleparent)) %>% 
  mutate(Percentage = round(Freq/sum(Freq)*100,2)) %>% 
  arrange(desc(Percentage))

singleparent_table <- singleparent %>% 
  gt() %>% 
  cols_label(Var1 = "Response",
             Freq = "Count") %>% 
  cols_align(
    align = "left",
    columns = Var1
  )

singleparent_table
```




### Are there any individuals living in your household who are older than 65 years old?

```{r over 65}

over65 <- as.data.frame(table(qualtrics_data$over65)) %>% 
  mutate(Percentage = round(Freq/sum(Freq)*100,2)) %>% 
  arrange(desc(Percentage))

over65_table <- over65 %>% 
  gt() %>% 
  cols_label(Var1 = "Response",
             Freq = "Count") %>% 
  cols_align(
    align = "left",
    columns = Var1
  )

over65_table
```

### Was the employment of anyone in your household affected by the COVID pandemic?

```{r employaffected}

employaffected <- as.data.frame(table(qualtrics_data$employaffected)) %>% 
  mutate(Percentage = round(Freq/sum(Freq)*100,2)) %>% 
  arrange(desc(Percentage))

employaffected_table <- employaffected %>% 
  gt() %>% 
  cols_label(Var1 = "Response",
             Freq = "Count") %>% 
  cols_align(
    align = "left",
    columns = Var1
  )

employaffected_table
```


### Did someone in the household experience a temporary reduction in hours worked?

```{r tempreducthours}

tempreducthours <- as.data.frame(table(qualtrics_data$tempreducthours)) %>% 
  mutate(Percentage = round(Freq/sum(Freq)*100,2)) %>% 
  arrange(desc(Percentage))

tempreducthours_table <- tempreducthours %>% 
  gt() %>% 
  cols_label(Var1 = "Response",
             Freq = "Count") %>% 
  cols_align(
    align = "left",
    columns = Var1
  )

tempreducthours_table
```


### Did someone in the household experience a permanent reduction in hours worked?

```{r permreducthours}

permreducthours <- as.data.frame(table(qualtrics_data$permreducthours)) %>% 
  mutate(Percentage = round(Freq/sum(Freq)*100,2)) %>% 
  arrange(desc(Percentage))

permreducthours_table <- permreducthours %>% 
  gt() %>% 
  cols_label(Var1 = "Response",
             Freq = "Count") %>% 
  cols_align(
    align = "left",
    columns = Var1
  )

permreducthours_table
```

### Did someone in the household become temporarily out of work?

```{r tempoow}

tempoow <- as.data.frame(table(qualtrics_data$tempoow)) %>% 
  mutate(Percentage = round(Freq/sum(Freq)*100,2)) %>% 
  arrange(desc(Percentage))

tempoow_table <- tempoow %>% 
  gt() %>% 
  cols_label(Var1 = "Response",
             Freq = "Count") %>% 
  cols_align(
    align = "left",
    columns = Var1
  )

tempoow_table
```


### Did someone in the household become permanently out of work?

```{r permoow}

permoow <- as.data.frame(table(qualtrics_data$permoow)) %>% 
  mutate(Percentage = round(Freq/sum(Freq)*100,2)) %>% 
  arrange(desc(Percentage))

permoow_table <- permoow %>% 
  gt() %>% 
  cols_label(Var1 = "Response",
             Freq = "Count") %>% 
  cols_align(
    align = "left",
    columns = Var1
  )

permoow_table
```

### If you are still working, are you able to work remotely?

```{r workremote}

workremote <- as.data.frame(table(qualtrics_data$workremote)) %>% 
  mutate(Percentage = round(Freq/sum(Freq)*100,2)) %>% 
  arrange(desc(Percentage))

workremote_table <- workremote %>% 
  gt() %>% 
  cols_label(Var1 = "Response",
             Freq = "Count") %>% 
  cols_align(
    align = "left",
    columns = Var1
  )

workremote_table
```

\newpage


### How did you find work during COVID?


```{r howfoundwork}

howfoundwork <- as.data.frame(table(qualtrics_data$howfoundwork)) %>% 
  mutate(Percentage = round(Freq/sum(Freq)*100,2)) %>% 
  arrange(desc(Percentage))

howfoundwork_table <- howfoundwork %>% 
  gt() %>% 
  cols_label(Var1 = "Response",
             Freq = "Count") %>% 
  cols_align(
    align = "left",
    columns = Var1
  )

howfoundwork_table
```



### Do you require child care?

```{r childcare}

childcare <- as.data.frame(table(qualtrics_data$childcare)) %>% 
  mutate(Percentage = round(Freq/sum(Freq)*100,2)) %>% 
  arrange(desc(Percentage))

childcare_table <- childcare %>% 
  gt() %>% 
  cols_label(Var1 = "Response",
             Freq = "Count") %>% 
  cols_align(
    align = "left",
    columns = Var1
  )

childcare_table
```





### Since March 2020, did you access any services or resources from a nonprofit or community organization (for example, church, shelter, food pantry, etc.)?

```{r services}

services <- as.data.frame(table(qualtrics_data$services)) %>% 
  mutate(Percentage = round(Freq/sum(Freq)*100,2)) %>% 
  arrange(desc(Percentage))

services_table <- services %>% 
  gt() %>% 
  cols_label(Var1 = "Response",
             Freq = "Count") %>% 
  cols_align(
    align = "left",
    columns = Var1
  )

services_table
```



### If yes, was this the first time you needed resources from nonprofit or community organizations?

```{r servicesfirsttime}

servicesfirsttime <- as.data.frame(table(qualtrics_data$servicesfirsttime)) %>% 
  mutate(Percentage = round(Freq/sum(Freq)*100,2)) %>% 
  arrange(desc(Percentage))

servicesfirsttime_table <- servicesfirsttime %>% 
  gt() %>% 
  cols_label(Var1 = "Response",
             Freq = "Count") %>% 
  cols_align(
    align = "left",
    columns = Var1
  )

servicesfirsttime_table
```




### Do you have access to the COVID vaccine and/or booster?

```{r covidvaccineavail}


covidvaccineavail <- as.data.frame(table(qualtrics_data$covidvaccineavail)) %>% 
  mutate(Percentage = round(Freq/sum(Freq)*100,2)) %>% 
  arrange(desc(Percentage))

covidvaccineavail_table <- covidvaccineavail %>% 
  gt() %>% 
  cols_label(Var1 = "Response",
             Freq = "Count") %>% 
  cols_align(
    align = "left",
    columns = Var1
  )

covidvaccineavail_table
```


### Do you have internet access?

```{r internetaccess}

internetaccess <- as.data.frame(table(qualtrics_data$internetaccess)) %>% 
  mutate(Percentage = round(Freq/sum(Freq)*100,2)) %>% 
  arrange(desc(Percentage))

internetaccess_table <- internetaccess %>% 
  gt() %>% 
  cols_label(Var1 = "Response",
             Freq = "Count") %>% 
  cols_align(
    align = "left",
    columns = Var1
  )

internetaccess_table
```



### Do you have access to an internet-connected device in your home (for example, computer/laptop, smartphone, or tablet)?

```{r internetaccesshome}

internetaccesshome <- as.data.frame(table(qualtrics_data$internetaccesshome)) %>% 
  mutate(Percentage = round(Freq/sum(Freq)*100,2)) %>% 
  arrange(desc(Percentage))

internetaccesshome_table <- internetaccesshome %>% 
  gt() %>% 
  cols_label(Var1 = "Response",
             Freq = "Count") %>% 
  cols_align(
    align = "left",
    columns = Var1
  )

internetaccesshome_table
```



### There is ________ food in my home to satisfy the needs of those in the household

```{r foodsecurity}

qualtrics_data$foodsecurity <- recode(qualtrics_data$foodsecurity,
                                      "There is always enough food in my home to satisfy the needs of those in the household" = "Always Enough",
                                      "There is mostly enough food in my home to satisfy the needs of those in the household" = "Mostly Enough",
                                      "There is never enough food in my home to satisfy the needs of those in the household" = "Never Enough",
                                      "There is rarely enough food in my home to satisfy the needs of those in the household" = "Rarely Enough")

foodsecurity <- as.data.frame(table(qualtrics_data$foodsecurity)) %>% 
  mutate(Percentage = round(Freq/sum(Freq)*100,2)) %>% 
  arrange(desc(Percentage))

foodsecurity_table <- foodsecurity %>% 
  gt() %>% 
  cols_label(Var1 = "Response",
             Freq = "Count") %>% 
  cols_align(
    align = "left",
    columns = Var1
  )

foodsecurity_table
```



### If there was an emergency today and you needed $400, how would you handle the situation?

```{r fourhundred}

fourhundred <- as.data.frame(table(qualtrics_data$fourhundred)) %>% 
  mutate(Percentage = round(Freq/sum(Freq)*100,2)) %>% 
  arrange(desc(Percentage))

fourhundred_table <- fourhundred %>% 
  gt() %>% 
  cols_label(Var1 = "Response",
             Freq = "Count") %>% 
  cols_align(
    align = "left",
    columns = Var1
  )

fourhundred_table
```
